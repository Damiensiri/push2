<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Notifications</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#f4f4f4;
}

/* ===== TOP BAR ===== */
#topbar{
  height:60px;
  background:#1f5c8f;
  color:white;
  display:flex;
  align-items:center;
  justify-content:center;
  position:sticky;
  top:0;
  z-index:10;
  font-size:18px;
  font-weight:600;
}

/* ===== BELL ===== */
#bell{
  position:absolute;
  right:15px;
  font-size:22px;
  cursor:pointer;
}

#badge{
  position:absolute;
  top:-6px;
  right:-8px;
  background:red;
  color:white;
  font-size:11px;
  width:18px;
  height:18px;
  border-radius:50%;
  display:none;
  align-items:center;
  justify-content:center;
  font-weight:600;
}

/* ===== LIST ===== */
#container{
  padding:12px;
}

.notif{
  background:white;
  padding:15px;
  margin-bottom:12px;
  border-radius:12px;
  box-shadow:0 2px 8px rgba(0,0,0,0.08);
  cursor:pointer;
}

.notif.lu{ opacity:0.4; }
.notif.epingle{ border-left:4px solid #1f5c8f; }

.date{
  font-size:12px;
  opacity:0.6;
  margin-top:5px;
}
</style>
</head>

<body>

<!-- HEADER -->
<div id="topbar">
  Notifications
  <div id="bell">ðŸ””<span id="badge"></span></div>
</div>

<div id="container"></div>

<script>

/* ===== CONFIG ===== */

const DATA_URL = "TON_URL_JSON_ICI";
const STORAGE_KEY = "notif_lues";

/* ===== STORAGE ===== */

function getLues(){
  return JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]");
}
function setLues(v){
  localStorage.setItem(STORAGE_KEY,JSON.stringify(v));
}
function estLu(id){
  return getLues().includes(id);
}
function marquerLu(id){
  const l=getLues();
  if(!l.includes(id)){ l.push(id); setLues(l); }
}

/* ===== LOAD ===== */

function loadNotifications(){

fetch(DATA_URL)
.then(r=>r.json())
.then(data=>{

  const box=document.getElementById("container");
  const badge=document.getElementById("badge");

  box.innerHTML="";
  let nonLues=0;

  data.forEach((n,i)=>{

    if(n.expire && new Date(n.expire)<new Date()) return;

    const d=document.createElement("div");
    d.className="notif";

    if(estLu(i)){
      d.classList.add("lu");
    }else{
      nonLues++;
    }

    if(n.epingle==="oui"){
      d.classList.add("epingle");
    }

    d.innerHTML=`
      <strong>${n.titre}</strong><br>
      ${n.message}
      <div class="date">${n.date || ""}</div>
    `;

    d.onclick=()=>{
      marquerLu(i);
      d.classList.add("lu");
      loadNotifications();
    };

    box.appendChild(d);
  });

  if(nonLues>0){
    badge.style.display="flex";
    badge.innerText=nonLues;
  }else{
    badge.style.display="none";
  }

});

}

loadNotifications();
setInterval(loadNotifications,60000);

</script>

</body>
</html>
